<div class="container">
    <div class="comapny_section">


      <div class="header_section">

        <div class="row">
            <div class="col-md-4">
                <h1>Leave Approval Level</h1>
            </div>
            <div class="col-md-3">
                
                <!-- <input type="text" class="form-control mt-1" placeholder="Search by name " [(ngModel)]="searchQuery" (input)="filterEmployees()"> -->

            </div>
            <div class="col-md-5">
                <div class="button-group pull-right">
                    <button type="button" (click)="openPopus()" class="btn-Create btn btn-success " ><span class="header-btn-icon"><i class="fa-solid fa-circle-plus"></i>
                    </span> Create</button>
                    <span *ngIf="!hasAddPermission"></span>

                    <button type="button" class="btn-Edit btn-info btn"  (click)="EditShowButtons()" *ngIf="hasEditPermission">
                        <span class="header-btn-icon">
                         <mat-icon>draw
                    </mat-icon></span> Edit</button>
                    <span *ngIf="hasEditPermission"></span>

                    <button type="button" class="btn-Delete btn btn-danger" (click)="toggleCheckboxes()" *ngIf="hasDeletePermission">
                        <span class="header-btn-icon">
                            <mat-icon> delete
                       </mat-icon></span> {{ Delete ? 'Cancel' : 'Delete' }}</button>
                       
                       <span *ngIf="!hasDeletePermission"></span>
                </div>
            </div>
        </div>
       
       

    </div>

    <div class="row">
      <div class="col-md-2">
          
          <button  class=" mt-3 btn-danger btn " style="width: 100%;" color="warn" *ngIf="Delete" (click)="toggleSelectAllEmployees()">Select All</button>

      </div>
      <div class="col-md-3">
          <button class=" mt-3 btn-danger btn"  color="warn" *ngIf="Delete" (click)="deleteSelectedAssetType()">Delete Selected </button>

      </div>
  </div>
  

    <div *ngIf="iscreateLoanApp" class="modal">
        <div class="modal-content">
          <div class="row">
            <div class="col-md-10">
              <h2> Create Leave Approval Level </h2>
            </div>
            <div class="col-md-2">
              <span class="close pull-right" (click)="closeapplicationModal()">&times;</span>
            </div>
          </div>
          <hr />
      
     
          <form (ngSubmit)="SetLeaveApprovaLevel()" enctype="multipart/form-data">
            <div class="row">
              <div class="col-md-6">
                <label>Level</label>
                <input type="number" class="form-control" required [(ngModel)]="level" placeholder="Enter level"
                       [ngModelOptions]="{standalone: true}" [ngClass]="{'error-field': registerButtonClicked && !level}">
                <div *ngIf="registerButtonClicked && !level" class="error-message">Level field is required.</div>
              </div>
          
              <!-- <div class="col-md-6">
                <label>Role</label>
                <input type="text" class="form-control" required [(ngModel)]="role" placeholder="Enter role"
                       [ngModelOptions]="{standalone: true}" [ngClass]="{'error-field': registerButtonClicked && !role}">
                <div *ngIf="registerButtonClicked && !role" class="error-message">role field is required.</div>
              </div> -->
          
            

         

         
              <div class="col-md-6">
                <label></label>
                <div class="check-box-selection-sec form-control mt-3">
                  <div class="mat-set">
                    <mat-checkbox [(ngModel)]="is_compensatory" [ngModelOptions]="{standalone: true}">Is Compensatory</mat-checkbox>
                  </div>
                </div>
              </div>
              
      

              <!-- Conditionally hide this section based on the is_compensatory value -->
<div class="col-md-6" *ngIf="!is_compensatory">
<label>Leave Type</label>
<div class="custom-sel">
  <select
    class="form-control"
    id="request_type"
    name="request_type"
    [(ngModel)]="request_type"
    [ngModelOptions]="{ standalone: true }"
  >
    <option *ngFor="let leavetype of LeaveTypes" [value]="leavetype.id">
      {{ leavetype.name }}
    </option>
  </select>
</div>
</div>



<!--         
              <div class="col-md-6">
                <label>Approver</label>
                <div class="custom-sel">
                  <select class="form-control" id="approver" name="approver" [(ngModel)]="approver" [ngModelOptions]="{standalone: true}">
                    <option *ngFor="let approver of Users" [value]="approver.id">{{ approver.username }}</option>
                  </select>
                </div>
              </div> -->


             <!-- non-ess users  -->
            <div class="col-md-6">
            <div class="custom-sel">
                <label>Approver</label>
                <select class="form-control" id="approver" required [(ngModel)]="approver"  [ngModelOptions]="{standalone: true}" [ngClass]="{'error-field': registerButtonClicked && !approver}" >
                    <option value="" >Select</option>
                    <option *ngFor="let deparmentsec of Users" [value]="deparmentsec.id">{{ deparmentsec.username     }} </option>
                </select>
                <div *ngIf="registerButtonClicked && !approver" class="error-message">Please Select approver  </div>
            </div>
        </div>

              <div class="col-md-6">
                <label>Branch</label>
            
            
            
            
                <div class="custom-sel">
                    <div class="form-control-wrapper">
                  
            
                      <mat-form-field>
                        <!-- <mat-label>Favorite food</mat-label> -->
                        <mat-select placeholder="Select" [(ngModel)]="branch" [ngModelOptions]="{standalone: true}" #select multiple>
                          <div class="select-all">
                            <mat-checkbox [(ngModel)]="allSelected" [ngModelOptions]="{standalone: true}" (change)="toggleAllSelection()">
                              Select All
                            </mat-checkbox>
                          </div>
                          <input type="text" placeholder="serach" class="form-control">
            
                          <mat-option *ngFor="let deparmentsec of   Branches" [value]="deparmentsec.id">
                            {{ deparmentsec.branch_name }} 
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                      
                    </div>
                    <div *ngIf="registerButtonClicked && (!branch || branch.length === 0)" class="error-message">
                      Please Select Your branch
                    </div>
                  </div>
                            
            
            </div>
               
         
          
         
            </div>
          
            <div class="row"  *ngIf="hasAddPermission">
              <div class="col-md-9"></div>
              <div class="col-md-3">
                <button type="submit" class="btn btn-success btn-full mt-4">Add Leave Aproval Level</button>
              </div>
            </div>
          </form>

        
        </div>
      </div>

             <!-- Edit Modal -->
<div *ngIf="isEditModalOpen" class="modal">
<div class="modal-content">
<div class="row">
  <div class="col-md-10">
    <h2>Edit   Approval Level </h2>
  </div>
  <div class="col-md-2">
    <span class="close pull-right" (click)="closeEditModal()">&times;</span>
  </div>
</div>
<hr />

<form >
  <div class="row">
    <div class="col-md-6">
      <label>Level</label>
      <input type="number" class="form-control" required [(ngModel)]="editAsset.level" placeholder="Enter level"
             [ngModelOptions]="{standalone: true}" [ngClass]="{'error-field': registerButtonClicked && !level}">
      <div *ngIf="registerButtonClicked && !level" class="error-message">Level field is required.</div>
    </div>

    <!-- <div class="col-md-6">
      <label>Role</label>
      <input type="text" class="form-control" required [(ngModel)]="role" placeholder="Enter role"
             [ngModelOptions]="{standalone: true}" [ngClass]="{'error-field': registerButtonClicked && !role}">
      <div *ngIf="registerButtonClicked && !role" class="error-message">role field is required.</div>
    </div> -->

  




    <div class="col-md-6">
      <label></label>
      <div class="check-box-selection-sec form-control mt-3">
        <div class="mat-set">
          <mat-checkbox [(ngModel)]="editAsset.is_compensatory" [ngModelOptions]="{standalone: true}">Is Compensatory</mat-checkbox>
        </div>
      </div>
    </div>
    


    <!-- Conditionally hide this section based on the is_compensatory value -->
<div class="col-md-6" *ngIf="!is_compensatory">
<label>Leave Type</label>
<div class="custom-sel">
<select
class="form-control"
id="request_type"
name="request_type"
[(ngModel)]="editAsset.request_type"
[ngModelOptions]="{ standalone: true }"
>
<option *ngFor="let leavetype of LeaveTypes" [value]="leavetype.id">
{{ leavetype.name }}
</option>
</select>
</div>
</div>




    <div class="col-md-6">
      <label>Approver</label>
      <div class="custom-sel">
        <select class="form-control" id="approver" name="approver" [(ngModel)]="editAsset.approver" [ngModelOptions]="{standalone: true}">
          <option *ngFor="let approver of Users" [value]="approver.id">{{ approver.username }}</option>
        </select>
      </div>
    </div>

    <div class="col-md-6">
      <label>Branch</label>
  
  
  
  
      <div class="custom-sel">
          <div class="form-control-wrapper">
        
  
            <mat-form-field>
              <!-- <mat-label>Favorite food</mat-label> -->
              <mat-select placeholder="Select" [(ngModel)]="editAsset.branch" [ngModelOptions]="{standalone: true}" #select multiple>
                <div class="select-all">
                  <mat-checkbox [(ngModel)]="allSelected" [ngModelOptions]="{standalone: true}" (change)="toggleAllSelection()">
                    Select All
                  </mat-checkbox>
                </div>
                <input type="text" placeholder="serach" class="form-control">
  
                <mat-option *ngFor="let deparmentsec of   Branches" [value]="deparmentsec.id">
                  {{ deparmentsec.branch_name }} 
                </mat-option>
              </mat-select>
            </mat-form-field>
            
          </div>
          <div *ngIf="registerButtonClicked && (!branch || branch.length === 0)" class="error-message">
            Please Select Your branch
          </div>
        </div>
                  
  
  </div>
     



  </div>
  <div class="row" >
    <div class="col-md-9"></div>
    <div class="col-md-3">
      <button type="button" (click)="updateAssetType()"  class="btn btn-success btn-full mt-4">Update</button>
    </div>
  </div>
</form>



</div>
</div>


    
        
        <table class="mt-4" width="100%" *ngIf="hasViewPermission">
          <thead>
            <tr>
              <th>No</th>
              <th> Level  </th>
              <th> Branch</th>
              <th>Leave Type</th>
              <th>Approver</th>
              <th>Is compensatory</th>

  <th>Action</th>
             
            </tr>
          </thead>
          <tbody>
              
            <tr *ngFor="let docs of LeaveapprovalLevels;let i = index">
              <td>{{ i + 1 }}</td> 
              <td>{{ docs.level }}</td>
              <td>{{ docs.branch }}</td>
              <td>{{ docs.request_type }}</td> 
              <td>{{ docs.approver }}</td>
              <td>{{ docs.is_compensatory }}</td>
              <td>
                <button
                  mat-fab
                  color="primary"
                  aria-label="Edit icon"
                  *ngIf="showEditBtn"
  
                  
                  (click)="openEditModal(docs)"
                >
                  <mat-icon style="color: white;">draw</mat-icon>
                </button>
  
                <mat-checkbox *ngIf="Delete" [(ngModel)]="docs.selected" ></mat-checkbox>
  
              </td>
            </tr>
          
          </tbody>
        </table>




    </div>
</div>
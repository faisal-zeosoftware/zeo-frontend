<div class="container">
    <div class="comapny_section">
        <div class="tab_back mt-5">
            <mat-tab-group> 
                <mat-tab label="Leave Acrrual">
                    
                    <div class="tab_boddy">
                   
        <div class="com_list mt-4 " >
            <div class="cpm-sec">

                <h2>Leave Accrual</h2>
                <hr>
                
            
                   
<div class="row">
    <div class="col-md-6">
        <label>Select Employee</label>
        <div class="custom-sel">
          <select class="form-control" id="employee" name="employee"
                  [(ngModel)]="selectedEmployeeId"
                  (change)="onSelectEmployeeId()"
                  [ngModelOptions]="{standalone: true}">
            <option [ngValue]="null">-- Select --</option>
            <option *ngFor="let employee of Employees" [ngValue]="employee.id">
              {{ employee.emp_code }}
            </option>
          </select>
        </div>
      </div>
      
    <!-- <div class="col-md-6">
        <label>Year</label>
        <div class="custom-sel">
            <select class="form-control">
                <option>test</option>
            </select>
        </div>
    </div>

    <div class="col-md-6">
        <label>Month</label>
        <div class="custom-sel">
            <select class="form-control">
                <option>

                </option> </select>
        </div>
    </div> -->
</div>


<div  class="table-str" *ngIf="employeeAccruals">
    <h2 class="mt-4">Accrual Summary for {{ employeeAccruals.employee_name }} ({{ employeeAccruals.year }})</h2>
  
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Leave Type</th>
          <th>Accrual Rate</th>
          <th>Existing Balance</th>
          
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let item of employeeAccruals.leave_accrual_summary">
          <!-- Main row -->
          <tr>
            <td data-label="Leave Type">{{ item.leave_type }}</td>
            <td data-label="Accrual Rate">{{ item.accrual_rate }}</td>
            <td data-label="Existing Balance">{{ item.existing_balance }}</td>
          </tr>
      
          <!-- Nested table row for monthly accruals -->
          <tr *ngIf="item.monthly_accruals">
            <td  class="tdview" colspan="3">
     <table class="table table-sm table-bordered" width="100%">
        <thead>
    <tr>
      <th>Month</th>
      <th>Accrued Balance</th>
      <th>Total With Existing Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let monthData of item.monthly_accruals">
      <td data-label="Month">{{ monthData.month }}</td>
      <td data-label="Accrued Balance">{{ monthData.accrued_balance }}</td>
      <td data-label="Total With Existing Balance">{{ monthData.total_with_existing_balance }}</td>
    </tr>
  </tbody>
</table>

            </td>

<!-- for mobile responsive -->

      <div class="tdview" style="display: none;">       
     <table class="table table-sm table-bordered" width="100%">
        <thead>
    <tr>
      <th>Month</th>
      <th>Accrued Balance</th>
      <th>Total With Existing Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let monthData of item.monthly_accruals">
      <td data-label="Month">{{ monthData.month }}</td>
      <td data-label="Accrued Balance">{{ monthData.accrued_balance }}</td>
      <td data-label="Total With Existing Balance">{{ monthData.total_with_existing_balance }}</td>
    </tr>
  </tbody>
</table>   

</div> 

            
          </tr>
        </ng-container>
      </tbody>
      
    </table>
  </div>
  

                           
                  


            </div>


        

        </div>
                </div>
              </mat-tab>
                  <mat-tab label="Rest Accrual ">
      
                    <div class="tab_boddy">
                    
                        <div class="com_list mt-4 ">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="resetDate">Select Reset Date</label>
                                    <input
                                      type="date"
                                      id="resetDate"
                                      class="form-control"
                                      [(ngModel)]="resetDate"
                                      [ngModelOptions]="{standalone: true}"
                                    />
                                </div>
                            </div>
                         



                            <button class="btn btn-primary mt-2" (click)="previewLeaveReset()">Preview Leave Reset</button>
                          
                            <div *ngIf="resetPreviewResults && resetPreviewResults.length > 0" class="mt-4">
                              <h4>Reset Preview Results</h4>
                              <table class="table table-bordered table-striped mt-4">
                                <thead>
                                  <tr>
                                    <th>Employee</th>
                                    <th>Leave Type</th>
                                    <th>Reset Date</th>
                                    <th>Initial Balance</th>
                                    <th>Carry Forward</th>
                                    <th>Encashment</th>
                                    <th>Final Balance</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let row of resetPreviewResults">
                                    <td data-label="Employee">{{ row.employee }}</td>
                                    <td data-label="Leave Type">{{ row.leave_type }}</td>
                                    <td data-label="Reset Date">{{ row.reset_date }}</td>
                                    <td data-label="Initial Balance">{{ row.initial_balance }}</td>
                                    <td data-label="Carry Forward">{{ row.carry_forward }}</td>
                                    <td data-label="Encashment">{{ row.encashment }}</td>
                                    <td data-label="Final Balance">{{ row.final_balance }}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          
                       
                          

                    </div>
                      </mat-tab>
      
                 
                      </mat-tab-group> 
      
                      </div>







    </div>
</div>